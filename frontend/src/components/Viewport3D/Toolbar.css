/* 3D视口工具栏样式 */

.viewport-toolbar {
  backdrop-filter: blur(12px) saturate(180%);
  border-radius: 12px;
  padding: 8px;
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.12),
    0 2px 8px rgba(0, 0, 0, 0.08),
    inset 0 1px 0 rgba(255, 255, 255, 0.2);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  user-select: none;
  position: relative;
  overflow: hidden;
}

/* 毛玻璃增强效果 */
.viewport-toolbar::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.1) 0%,
    rgba(255, 255, 255, 0.05) 50%,
    rgba(0, 0, 0, 0.02) 100%);
  border-radius: inherit;
  pointer-events: none;
}

/* 主题适配 */
.viewport-toolbar.expanded {
  background: rgba(255, 255, 255, 0.9);
  border: 1px solid rgba(0, 0, 0, 0.1);
}

[data-theme='dark'] .viewport-toolbar.expanded {
  background: rgba(30, 30, 30, 0.9);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.viewport-toolbar.collapsed {
  background: transparent;
  padding: 0;
  box-shadow: none;
}

/* 工具栏按钮 */
.viewport-toolbar-button {
  width: 36px !important;
  height: 36px !important;
  min-width: 36px !important;
  border-radius: 8px !important;
  border: 1px solid rgba(0, 0, 0, 0.08) !important;
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.9) 0%,
    rgba(255, 255, 255, 0.7) 100%) !important;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 0 !important;
  position: relative !important;
  overflow: hidden !important;
  z-index: 1 !important;
}

/* 按钮悬浮光效 */
.viewport-toolbar-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, 
    transparent, 
    rgba(255, 255, 255, 0.3), 
    transparent);
  transition: left 0.5s ease;
  z-index: -1;
}

.viewport-toolbar-button:hover::before {
  left: 100%;
}

.viewport-toolbar-button:hover {
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 1) 0%,
    rgba(255, 255, 255, 0.95) 100%) !important;
  box-shadow: 
    0 4px 16px rgba(0, 0, 0, 0.12),
    0 2px 8px rgba(0, 0, 0, 0.08),
    inset 0 1px 0 rgba(255, 255, 255, 0.8) !important;
  transform: translateY(-2px) scale(1.05);
  border-color: rgba(0, 0, 0, 0.12) !important;
}

.viewport-toolbar-button.active,
.viewport-toolbar-button.special-active {
  background: linear-gradient(135deg, 
    var(--ant-color-primary) 0%,
    var(--ant-color-primary-active) 100%) !important;
  color: white !important;
  border-color: var(--ant-color-primary) !important;
  box-shadow: 
    0 4px 16px rgba(24, 144, 255, 0.3),
    0 2px 8px rgba(24, 144, 255, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
  transform: translateY(-1px);
}

.viewport-toolbar-button.active::before,
.viewport-toolbar-button.special-active::before {
  background: linear-gradient(90deg, 
    transparent, 
    rgba(255, 255, 255, 0.2), 
    transparent);
}

.viewport-toolbar-button.active:hover,
.viewport-toolbar-button.special-active:hover {
  background: linear-gradient(135deg, 
    var(--ant-color-primary-hover) 0%,
    var(--ant-color-primary-active) 100%) !important;
  border-color: var(--ant-color-primary-hover) !important;
  box-shadow: 
    0 6px 20px rgba(24, 144, 255, 0.4),
    0 3px 12px rgba(24, 144, 255, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
  transform: translateY(-2px) scale(1.05);
}

/* 图标旋转动画 */
.viewport-toolbar-button.active .anticon,
.viewport-toolbar-button.special-active .anticon {
  animation: iconPulse 2s ease-in-out infinite;
}

@keyframes iconPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.1); }
}

/* 深色主题按钮 */
[data-theme='dark'] .viewport-toolbar-button {
  background: rgba(50, 50, 50, 0.9) !important;
  border: 1px solid rgba(255, 255, 255, 0.2) !important;
  color: rgba(255, 255, 255, 0.85) !important;
}

[data-theme='dark'] .viewport-toolbar-button:hover {
  background: rgba(70, 70, 70, 1) !important;
  color: white !important;
}

/* 折叠模式切换按钮 */
.viewport-toolbar-toggle {
  width: 48px !important;
  height: 48px !important;
  border-radius: 12px !important;
  backdrop-filter: blur(10px);
  background: rgba(255, 255, 255, 0.9) !important;
  border: 1px solid rgba(0, 0, 0, 0.1) !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1) !important;
  transition: all 0.3s ease !important;
}

.viewport-toolbar-toggle:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
}

[data-theme='dark'] .viewport-toolbar-toggle {
  background: rgba(30, 30, 30, 0.9) !important;
  border: 1px solid rgba(255, 255, 255, 0.2) !important;
  color: rgba(255, 255, 255, 0.85) !important;
}

/* 垂直方向工具栏 */
.viewport-toolbar.vertical {
  flex-direction: column;
}

.viewport-toolbar.vertical .ant-space-compact {
  flex-direction: column;
}

/* 水平方向工具栏 */
.viewport-toolbar.horizontal {
  flex-direction: row;
}

.viewport-toolbar.horizontal .ant-space-compact {
  flex-direction: row;
}

/* 分隔线样式 */
.viewport-toolbar .ant-divider {
  background: rgba(0, 0, 0, 0.15);
  margin: 0 !important;
}

[data-theme='dark'] .viewport-toolbar .ant-divider {
  background: rgba(255, 255, 255, 0.2);
}

.viewport-toolbar.horizontal .ant-divider-vertical {
  height: 20px;
  margin: 0 4px !important;
}

.viewport-toolbar.vertical .ant-divider-horizontal {
  width: 20px;
  margin: 4px 0 !important;
}

/* 移动端适配 */
@media (max-width: 600px) {
  .viewport-toolbar {
    backdrop-filter: blur(8px);
  }
  
  .viewport-toolbar-button {
    width: 40px !important;
    height: 40px !important;
    min-width: 40px !important;
    border-radius: 8px !important;
  }
  
  .viewport-toolbar-toggle {
    width: 56px !important;
    height: 56px !important;
    border-radius: 16px !important;
  }
}

/* 平板适配 */
@media (max-width: 1024px) and (min-width: 601px) {
  .viewport-toolbar {
    padding: 6px;
  }
  
  .viewport-toolbar-button {
    width: 36px !important;
    height: 36px !important;
    min-width: 36px !important;
  }
}

/* 动画效果 */
.viewport-toolbar-button,
.viewport-toolbar-toggle {
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.viewport-toolbar-button:active {
  transform: translateY(0) scale(0.95);
}

.viewport-toolbar-toggle:active {
  transform: scale(0.95);
}

/* Tooltip 样式优化 */
.ant-tooltip .ant-tooltip-inner {
  background: rgba(30, 30, 30, 0.95);
  backdrop-filter: blur(8px);
  border-radius: 6px;
  font-size: 12px;
}

.ant-tooltip .ant-tooltip-arrow::before {
  background: rgba(30, 30, 30, 0.95);
}

/* 下拉菜单样式 */
.ant-dropdown .ant-dropdown-menu {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius: 8px;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

[data-theme='dark'] .ant-dropdown .ant-dropdown-menu {
  background: rgba(30, 30, 30, 0.95);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.ant-dropdown .ant-dropdown-menu-item {
  border-radius: 4px;
  margin: 2px 4px;
  transition: all 0.2s ease;
}

.ant-dropdown .ant-dropdown-menu-item:hover {
  background: var(--ant-color-primary-bg-hover);
}

/* 无障碍和焦点样式 */
.viewport-toolbar-button:focus-visible,
.viewport-toolbar-toggle:focus-visible {
  outline: 2px solid var(--ant-color-primary);
  outline-offset: 2px;
}

/* 特殊工具动画效果 */

/* 旋转工具 - 扫描动画 */
.viewport-toolbar-button[data-action="orbit"].active .anticon {
  animation: orbitScan 3s linear infinite;
}

@keyframes orbitScan {
  0% { transform: rotate(0deg) scale(1); }
  25% { transform: rotate(90deg) scale(1.1); }
  50% { transform: rotate(180deg) scale(1); }
  75% { transform: rotate(270deg) scale(1.1); }
  100% { transform: rotate(360deg) scale(1); }
}

/* 缩放工具 - 脉冲动画 */
.viewport-toolbar-button[data-action="zoom"].active .anticon {
  animation: zoomPulse 1.5s ease-in-out infinite;
}

@keyframes zoomPulse {
  0%, 100% { transform: scale(1); filter: brightness(1); }
  50% { transform: scale(1.2); filter: brightness(1.3); }
}

/* 测量工具 - 闪烁动画 */
.viewport-toolbar-button[data-action="measure"].active .anticon {
  animation: measureBlink 1s ease-in-out infinite;
}

@keyframes measureBlink {
  0%, 50%, 100% { opacity: 1; }
  25%, 75% { opacity: 0.6; }
}

/* 截图工具 - 闪光动画 */
.viewport-toolbar-button[data-action="screenshot"]:active .anticon {
  animation: flashCapture 0.3s ease-out;
}

@keyframes flashCapture {
  0% { transform: scale(1); filter: brightness(1); }
  50% { transform: scale(1.3); filter: brightness(2) saturate(2); }
  100% { transform: scale(1); filter: brightness(1); }
}

/* 设置工具 - 齿轮转动 */
.viewport-toolbar-button[data-action="settings"]:hover .anticon {
  animation: settingsRotate 2s linear infinite;
}

@keyframes settingsRotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

/* 霓虹灯效果（鼠标悬停） */
.viewport-toolbar-button:hover {
  box-shadow: 
    0 0 5px rgba(24, 144, 255, 0.3),
    0 0 10px rgba(24, 144, 255, 0.2),
    0 0 15px rgba(24, 144, 255, 0.1),
    0 4px 16px rgba(0, 0, 0, 0.12) !important;
}

.viewport-toolbar-button.active:hover {
  box-shadow: 
    0 0 8px var(--ant-color-primary),
    0 0 16px rgba(24, 144, 255, 0.4),
    0 0 24px rgba(24, 144, 255, 0.2),
    0 6px 20px rgba(24, 144, 255, 0.3) !important;
}

/* 彩虹边框（特殊状态） */
.viewport-toolbar-button.special-active {
  position: relative;
  border: 2px solid transparent;
  background: 
    linear-gradient(white, white) padding-box,
    linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7) border-box;
}

/* 粒子效果（点击时） */
.viewport-toolbar-button:active::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
  transform: translate(-50%, -50%);
  animation: clickRipple 0.6s ease-out;
}

@keyframes clickRipple {
  0% {
    width: 0;
    height: 0;
    opacity: 1;
  }
  100% {
    width: 40px;
    height: 40px;
    opacity: 0;
  }
}

/* 性能优化：减少重绘 */
.viewport-toolbar * {
  will-change: transform, opacity;
}

/* GPU加速 */
.viewport-toolbar-button,
.viewport-toolbar-button::before,
.viewport-toolbar-button::after,
.viewport-toolbar-button .anticon {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}