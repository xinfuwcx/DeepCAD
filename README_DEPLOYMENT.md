# DeepCAD 深基坑CAE平台 - 部署指南

## 🚀 拷贝即用部署方案

本项目已配置为完全便携式部署，可直接拷贝到任何Windows电脑并立即使用。

### 📋 系统要求

- **操作系统**: Windows 10/11 (x64)
- **Python**: 3.9+ (建议3.11)
- **Node.js**: 18.0+ (建议LTS版本)
- **内存**: 最低8GB，推荐16GB+
- **硬盘**: 最低10GB可用空间

### 🎯 一键部署流程

#### 步骤1: 拷贝项目文件
直接拷贝整个 `deepcad` 文件夹到目标计算机

#### 步骤2: 运行一键安装
```batch
双击运行 setup.bat
```

#### 步骤3: 启动服务
```batch
双击运行 start.bat
```

就是这么简单！🎉

---

## 📁 项目结构

```
deepcad/
├── 📄 setup.bat           # 一键安装脚本
├── 📄 start.bat           # 生产启动脚本
├── 📄 dev.bat             # 开发模式脚本
├── 📄 stop.bat            # 服务停止脚本
├── 📄 check_env.bat       # 环境检查脚本
├── 📄 create_shortcuts.bat # 创建桌面快捷方式
├── 📄 requirements.txt     # Python依赖清单
├── 📁 frontend/           # React前端应用
│   ├── 📄 package.json    # Node.js依赖
│   └── 📁 dist/           # 构建输出(运行后生成)
├── 📁 gateway/            # FastAPI网关服务
│   └── 📄 main.py         # 主服务入口
└── 📁 [其他模块]/         # 各功能模块
```

---

## 🛠️ 部署脚本说明

### setup.bat - 一键安装配置
- ✅ 自动检测Python/Node.js环境
- ✅ 安装所有Python依赖包
- ✅ 安装前端依赖并构建
- ✅ 验证关键组件
- ✅ 生成桌面快捷方式

### start.bat - 生产环境启动
- 🚀 启动后端API服务 (端口8000)
- 🚀 启动前端Web服务 (端口5173)
- 🌐 自动打开浏览器访问应用
- 📊 显示服务状态和访问地址

### dev.bat - 开发模式启动
- 🛠️ 启用代码热重载
- 📝 显示详细调试日志
- 🔧 开发者工具自动打开
- 🔄 文件变更自动刷新

### stop.bat - 服务停止工具
- 🛑 停止所有DeepCAD相关进程
- 🔌 释放占用的端口(8000, 5173)
- 🧹 清理临时文件和进程

### check_env.bat - 环境检查工具
- 🔍 检查Python/Node.js版本
- 📦 验证依赖包完整性
- 🏥 诊断常见环境问题
- 💊 提供修复建议

---

## 🌐 访问地址

部署成功后，可通过以下地址访问：

| 服务 | 地址 | 说明 |
|------|------|------|
| **主应用** | http://localhost:5173 | DeepCAD主界面 |
| **API服务** | http://localhost:8000 | 后端API接口 |
| **API文档** | http://localhost:8000/docs | Swagger文档 |
| **健康检查** | http://localhost:8000/api/health | 服务状态 |

---

## 🔧 核心依赖组件

### Python科学计算栈
- **NumPy** 2.3.2 - 数值计算基础
- **SciPy** 1.16.1 - 高级科学计算
- **Pandas** 2.2.3 - 数据分析处理
- **PyVista** 0.48.4 - 3D可视化 (含VTK)
- **Gmsh** 4.13.1 - 网格生成
- **FastAPI** 0.117.0 - 高性能Web框架

### 前端技术栈
- **React** 18.3.1 - 用户界面框架
- **Three.js** 0.171.0 - 3D图形渲染
- **@react-three/fiber** 8.18.0 - React三维集成
- **Vite** 6.0.7 - 现代构建工具

### CAE专业组件
- **Kratos Multiphysics** 10.3+ - 有限元计算引擎
- **WebGPU** - 高性能GPU计算
- **RBF插值** - 径向基函数算法

---

## 🚨 故障排除

### 常见问题

#### 1. Python环境问题
```bash
错误: 'python' 不是内部或外部命令
解决: 安装Python 3.9+并添加到系统PATH
```

#### 2. Node.js环境问题
```bash
错误: 'npm' 不是内部或外部命令
解决: 安装Node.js 18+并添加到系统PATH
```

#### 3. 端口占用问题
```bash
错误: 端口8000或5173被占用
解决: 运行 stop.bat 或手动关闭占用进程
```

#### 4. 依赖安装失败
```bash
错误: pip install失败
解决: 检查网络连接，使用国内镜像源
```

### 高级诊断

如遇到问题，请按顺序执行：

1. **环境检查**: 运行 `check_env.bat`
2. **重新安装**: 运行 `setup.bat`
3. **手动诊断**: 查看错误日志
4. **端口检查**: 使用 `netstat -an | findstr :8000`

---

## 📊 性能优化建议

### 系统配置
- **内存**: 16GB+ 推荐用于大型模型
- **GPU**: 支持WebGPU加速渲染
- **SSD**: 提升文件I/O性能
- **网络**: 局域网部署获得最佳体验

### 软件优化
- 关闭不必要的后台程序
- 确保杀毒软件白名单添加项目目录
- 定期清理临时文件

---

## 📞 技术支持

### 快速帮助
- 🔍 运行 `check_env.bat` 进行环境诊断
- 📋 查看服务日志定位问题
- 🛑 使用 `stop.bat` 重置服务状态

### 项目信息
- **版本**: DeepCAD v3.0.0
- **架构**: FastAPI + React + WebGPU
- **更新**: 2025年7月31日

---

## ✅ 部署检查清单

部署完成后，请确认以下项目：

- [ ] Python环境正常 (python --version)
- [ ] Node.js环境正常 (node --version)
- [ ] 依赖包安装完成 (pip list)
- [ ] 前端构建成功 (frontend/dist存在)
- [ ] 后端服务启动 (http://localhost:8000/api/health)
- [ ] 前端界面访问 (http://localhost:5173)
- [ ] 桌面快捷方式创建
- [ ] 核心功能测试通过

---

**🎯 目标达成**: 真正的"拷贝即用"部署方案，让DeepCAD深基坑CAE平台在任何Windows环境下都能快速部署和运行！