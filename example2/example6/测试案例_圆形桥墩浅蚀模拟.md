# 圆形桥墩浅蚀模拟测试案例

## 案例概述

本案例模拟一个直径2m的圆形桥墩在均匀流场中的浅蚀过程，基于Melville实验室的经典测试数据进行验证。

## 几何参数

### 桥墩几何
- **形状**: 圆形截面
- **直径 (D)**: 2.0 m
- **高度**: 10.0 m  
- **位置**: (0, 0, 0) - 计算域中心
- **材质**: 混凝土（粗糙度 ks = 0.5 mm）

### 计算域设置
```
长度方向 (x): -10D ~ +20D  (-20m ~ +40m)
宽度方向 (y): -10D ~ +10D  (-20m ~ +20m) 
深度方向 (z): -2D ~ +2D    (-4m ~ +4m)
```

### 河床几何
- **初始河床标高**: z = -3.0 m
- **河床材料**: 均匀砂土
- **中值粒径 (d50)**: 0.8 mm
- **沉积物密度**: 2650 kg/m³
- **孔隙率**: 0.4

## 流体条件

### 水动力参数
```python
# 基本流动参数
flow_velocity = 0.8      # 来流速度 (m/s)
water_depth = 3.0        # 水深 (m)
water_temperature = 20   # 水温 (°C)
water_density = 998.2    # 水密度 (kg/m³)
kinematic_viscosity = 1.004e-6  # 运动粘度 (m²/s)

# 无量纲参数
reynolds_number = flow_velocity * pier_diameter / kinematic_viscosity  # Re = 1.6×10⁶
froude_number = flow_velocity / (9.81 * water_depth)**0.5  # Fr = 0.147

# 临界流速
critical_velocity = 0.045 * (2650/998.2 - 1)**0.5 * 9.81**0.5 * (0.8e-3)**0.5  # ≈ 0.35 m/s
velocity_ratio = flow_velocity / critical_velocity  # V/Vc = 2.29
```

### 边界条件
- **入流边界**: 均匀流速 0.8 m/s，湍流强度 5%
- **出流边界**: 压力出口，相对压力 0 Pa
- **自由表面**: 滑移壁面
- **河床**: 可移动边界
- **桥墩**: 无滑移壁面

## 浅蚀计算

### 经验公式计算

#### HEC-RAS公式 (Melville & Coleman, 2000)
```python
def calculate_scour_depth_hec():
    # 形状系数
    K1 = 1.0  # 圆形桥墩
    
    # 角度系数  
    K2 = 1.0  # 正向来流
    
    # 河床条件系数
    K3 = 1.1  # 平坦河床
    
    # 沉积物系数
    sigma_g = 1.5  # 级配不均匀性
    if sigma_g < 1.35:
        K4 = 1.0
    else:
        K4 = (587 * (d50*1000)**0.64 * sigma_g**(-0.89))**(-0.204)
    
    # 装甲化系数
    K5 = 1.0  # 无装甲化
    
    # 最大浅蚀深度
    ds_max = K1 * K2 * K3 * K4 * K5 * pier_diameter
    return ds_max

predicted_scour = calculate_scour_depth_hec()  # ≈ 2.2 m
```

#### CSU公式 (Richardson & Davis, 2001)
```python
def calculate_scour_depth_csu():
    K1 = 1.0   # 圆形桥墩
    K2 = 1.0   # 直流
    K3 = 1.0   # 平坦河床  
    K4 = 1.0   # 装甲化系数
    
    ds_D = 2.0 * K1 * K2 * K3 * K4 * (velocity_ratio)**0.35
    ds_max = ds_D * pier_diameter
    return ds_max

predicted_scour_csu = calculate_scour_depth_csu()  # ≈ 2.4 m
```

### 时间演化模型
```python
def scour_time_evolution(t, T=24*3600):  # T = 1天
    """浅蚀深度时间发展"""
    ds_max = 2.2  # 最大浅蚀深度
    return ds_max * (1 - np.exp(-t/T))

# 关键时间点的浅蚀深度
t_6h = scour_time_evolution(6*3600)    # 6小时: 1.4 m  
t_24h = scour_time_evolution(24*3600)  # 24小时: 1.9 m
t_72h = scour_time_evolution(72*3600)  # 72小时: 2.1 m
```

## OpenFOAM案例设置

### 网格生成 (blockMeshDict)
```cpp
// blockMeshDict
vertices
(
    (-20 -20 -4)  // 0
    ( 40 -20 -4)  // 1  
    ( 40  20 -4)  // 2
    (-20  20 -4)  // 3
    (-20 -20  4)  // 4
    ( 40 -20  4)  // 5
    ( 40  20  4)  // 6  
    (-20  20  4)  // 7
);

blocks
(
    hex (0 1 2 3 4 5 6 7) (300 200 40) simpleGrading (1 1 1)
);

boundary
(
    inlet
    {
        type patch;
        faces ((0 4 7 3));
    }
    outlet  
    {
        type patch;
        faces ((1 2 6 5));
    }
    bottom
    {
        type wall;
        faces ((0 1 2 3));
    }
    top
    {
        type patch;
        faces ((4 5 6 7));
    }
    sides
    {
        type symmetryPlane;
        faces 
        (
            (0 1 5 4)
            (3 7 6 2)
        );
    }
);
```

### 桥墩几何 (snappyHexMeshDict)
```cpp
geometry
{
    pier.stl
    {
        type triSurfaceMesh;
        name pier;
    }
}

castellatedMeshControls
{
    maxLocalCells 2000000;
    maxGlobalCells 5000000;
    minRefinementCells 10;
    maxLoadUnbalance 0.10;
    nCellsBetweenLevels 3;

    features
    (
        {
            file "pier.eMesh";
            level 2;
        }
    );

    refinementSurfaces
    {
        pier
        {
            level (3 4);
            patchInfo
            {
                type wall;
            }
        }
    }

    refinementRegions
    {
        pier_wake
        {
            mode inside;
            levels ((1.0 2));
        }
    }
}
```

### 湍流模型设置 (turbulenceProperties)
```cpp
simulationType RAS;

RAS
{
    RASModel        kEpsilon;
    
    turbulence      on;
    printCoeffs     on;
    
    kEpsilonCoeffs
    {
        Cmu             0.09;
        C1              1.44;
        C2              1.92;
        C3              -0.33;
        sigmak          1.0;
        sigmaEps        1.3;
    }
}
```

### 边界条件

#### 速度场 (U)
```cpp
dimensions      [0 1 -1 0 0 0 0];
internalField   uniform (0.8 0 0);

boundaryField
{
    inlet
    {
        type            fixedValue;
        value           uniform (0.8 0 0);
    }
    
    outlet
    {
        type            zeroGradient;
    }
    
    pier
    {
        type            noSlip;
    }
    
    bottom
    {
        type            noSlip;  // 可移动床面
    }
    
    top
    {
        type            slip;
    }
}
```

#### 压力场 (p)
```cpp
dimensions      [0 2 -2 0 0 0 0];
internalField   uniform 0;

boundaryField
{
    inlet
    {
        type            zeroGradient;
    }
    
    outlet
    {
        type            fixedValue;
        value           uniform 0;
    }
    
    pier
    {
        type            zeroGradient;
    }
    
    bottom
    {
        type            zeroGradient;
    }
}
```

## 求解器设置

### 控制参数 (controlDict)
```cpp
application     pimpleFoam;
startFrom       startTime;
startTime       0;
stopAt          endTime;
endTime         259200;  // 72小时
deltaT          0.1;
writeControl    adjustableRunTime;  
writeInterval   3600;    // 每小时输出一次
maxCo           0.5;
maxDeltaT       1;
```

### 数值方案 (fvSchemes)
```cpp
ddtSchemes
{
    default         Euler;
}

gradSchemes  
{
    default         Gauss linear;
    grad(p)         Gauss linear;
    grad(U)         Gauss linear;
}

divSchemes
{
    default         none;
    div(phi,U)      Gauss linearUpwind grad(U);
    div(phi,k)      Gauss linearUpwind grad(k);
    div(phi,epsilon) Gauss linearUpwind grad(epsilon);
    div((nuEff*dev2(T(grad(U))))) Gauss linear;
}

laplacianSchemes
{
    default         Gauss linear orthogonal;
}
```

## 后处理分析

### 监测点设置
```python
# 关键监测点坐标 (相对桥墩中心)
monitoring_points = {
    'upstream': [-2.0, 0.0, -3.0],    # 上游2D处河床
    'pier_front': [1.0, 0.0, -3.0],   # 桥墩前缘
    'pier_side': [0.0, 1.0, -3.0],    # 桥墩侧面
    'pier_wake': [-2.0, 0.0, -3.0],   # 桥墩尾流区
    'downstream': [10.0, 0.0, -3.0]   # 下游10D处
}
```

### 结果验证指标
```python
# 与实验数据对比
experimental_data = {
    'max_scour_depth': 2.1,     # Melville实验值 (m)
    'scour_width': 3.2,         # 浅蚀坑宽度 (m) 
    'time_to_90_percent': 48,   # 达到90%浅蚀深度时间 (h)
}

# 计算误差
def calculate_error(computed, experimental):
    return abs(computed - experimental) / experimental * 100

scour_depth_error = calculate_error(computed_max_scour, 2.1)
print(f"浅蚀深度误差: {scour_depth_error:.1f}%")
```

### 可视化输出
```python
# PyVista可视化脚本
import pyvista as pv
import numpy as np

def visualize_scour_results():
    # 读取VTK结果文件
    mesh = pv.read('scour_results_72h.vtk')
    
    # 创建浅蚀深度等值线
    contours = mesh.contour(scalars='bed_elevation', isosurfaces=10)
    
    # 绘制3D视图
    plotter = pv.Plotter()
    plotter.add_mesh(mesh, scalars='velocity_magnitude', cmap='viridis')
    plotter.add_mesh(contours, color='red', line_width=2)
    plotter.show()

# 生成动画
def create_scour_animation():
    """生成浅蚀过程动画"""
    time_steps = np.arange(0, 72*3600, 3600)  # 每小时一帧
    
    for i, t in enumerate(time_steps):
        mesh = pv.read(f'results/scour_{i:03d}.vtk')
        # 渲染并保存帧
        plotter.write_frame()
    
    # 输出MP4动画
    plotter.close()
```

## 预期结果

### 流场特征
- **最大流速**: 桥墩前缘附近约1.2 m/s
- **回流区长度**: 约4-6D (8-12m)
- **涡街频率**: St ≈ 0.2，频率约0.08 Hz

### 浅蚀特征  
- **最大浅蚀深度**: 2.0-2.4 m (1.0-1.2D)
- **浅蚀坑形状**: 马蹄涡型，前深后浅
- **平衡时间**: 48-72小时

### 验证标准
- 浅蚀深度误差 < 15%
- 压力分布与实验一致
- 流场结构符合理论预期

## 案例文件结构
```
bridge_pier_scour_case/
├── 0/                    # 初始条件
│   ├── U
│   ├── p  
│   ├── k
│   ├── epsilon
│   └── nut
├── constant/             # 常数设置
│   ├── polyMesh/
│   ├── turbulenceProperties
│   └── transportProperties
├── system/              # 求解器设置
│   ├── controlDict
│   ├── fvSchemes
│   ├── fvSolution
│   ├── blockMeshDict
│   └── snappyHexMeshDict
├── geometry/            # 几何文件
│   └── pier.stl
└── postProcessing/      # 后处理脚本
    ├── visualization.py
    └── analysis.py
```

这个完整的测试案例为桥墩浅蚀模拟提供了从几何建模到结果分析的全流程方案，可以作为PyQt6 GUI程序的标准测试用例。