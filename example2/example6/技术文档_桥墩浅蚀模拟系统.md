# 桥墩浅蚀模拟系统技术文档

## 项目概述

本项目将在DeepCAD系统的example6模块中实现一个完整的桥墩浅蚀（scour）算法模拟系统，用于计算和可视化水流对桥墩的冲刷效应。系统采用PyQt6构建用户界面，集成多个开源计算流体力学库进行数值模拟。

## 系统架构设计

### 1. 核心模块结构
```
example6/
├── core/
│   ├── __init__.py
│   ├── scour_solver.py          # 浅蚀算法核心引擎
│   ├── fluid_dynamics.py        # 流体力学计算
│   ├── sediment_transport.py    # 泥沙输运模型
│   └── mesh_generator.py        # 网格生成工具
├── gui/
│   ├── __init__.py
│   ├── main_window.py           # 主界面窗口
│   ├── visualization.py         # 3D可视化组件
│   ├── parameter_panel.py       # 参数设置面板
│   └── results_viewer.py        # 结果查看器
├── algorithms/
│   ├── __init__.py
│   ├── scour_equations.py       # 浅蚀经验公式
│   ├── pier_geometry.py         # 桥墩几何处理
│   └── flow_analysis.py         # 流场分析
├── utils/
│   ├── __init__.py
│   ├── data_manager.py          # 数据管理
│   ├── export_tools.py          # 结果导出
│   └── validation.py            # 数据验证
├── data/
│   ├── test_cases/              # 测试案例
│   └── materials/               # 材料数据库
├── main.py                      # 程序入口
└── requirements.txt             # 依赖包列表
```

### 2. 技术栈选择

#### 2.1 GUI框架
- **PyQt6**: 现代化界面框架，支持高分辨率显示
- **qtawesome**: 矢量图标库
- **PyQt6-tools**: 开发工具集

#### 2.2 数值计算库
- **NumPy**: 基础数组运算
- **SciPy**: 科学计算工具
- **pandas**: 数据处理和分析
- **meshio**: 网格文件读写

#### 2.3 可视化库
- **PyVista**: 3D科学可视化（基于VTK）
- **pyvistaqt**: PyVista的Qt集成
- **matplotlib**: 2D图表绘制

#### 2.4 流体动力学库
- **FluidSim**: Python CFD框架（可选）
- **OpenFOAM-Python接口**: 通过subprocess调用
- **自实现算法**: 基于经验公式的简化模型

## 核心算法设计

### 1. 浅蚀计算模型

#### 1.1 HEC-RAS浅蚀方程
基于Melville & Coleman (2000)方程：
```
ds = K1 × K2 × K3 × K4 × K5 × D
```
其中：
- ds: 最大浅蚀深度
- K1: 桩基形状系数
- K2: 流速角度系数  
- K3: 河床条件系数
- K4: 沉积物级配系数
- K5: 装甲化系数
- D: 桩基直径

#### 1.2 CSU方程（Richardson & Davis, 2001）
```
ds/D = 2.0 × K1 × K2 × K3 × K4 × (V/Vc)^0.35
```

#### 1.3 时间演化模型
```
ds(t) = ds_max × (1 - exp(-t/T))
```

### 2. 流场计算

#### 2.1 简化NS方程
对于不可压缩粘性流：
```
∂u/∂t + u·∇u = -∇p/ρ + ν∇²u
∇·u = 0
```

#### 2.2 紊流模型
采用k-ε模型或Spalart-Allmaras模型

### 3. 泥沙输运

#### 3.1 Exner方程
```
(1-n)∂η/∂t + ∇·qs = 0
```
其中：
- η: 河床高程
- n: 孔隙率
- qs: 泥沙通量

#### 3.2 输运率公式
采用Van Rijn或Meyer-Peter-Muller公式

## GUI界面设计

### 1. 主界面布局
```
┌─────────────────────────────────────────┐
│ File Edit View Tools Help               │ 菜单栏
├─────────────────────────────────────────┤
│ [New] [Open] [Save] [Run] [Export]      │ 工具栏
├──────────────┬──────────────────────────┤
│ 参数设置面板 │                          │
│              │                          │
│ • 桥墩参数   │       3D可视化区域       │
│ • 流体参数   │                          │
│ • 沉积物参数 │                          │
│ • 求解设置   │                          │
│              │                          │
│ [开始计算]   │                          │
├──────────────┼──────────────────────────┤
│ 结果显示区域 │       状态信息栏         │
└──────────────┴──────────────────────────┘
```

### 2. 参数设置界面
- **桥墩几何**: 直径、形状、倾斜角度
- **流体条件**: 流速、水深、雷诺数
- **沉积物特性**: 粒径、密度、级配曲线
- **边界条件**: 入流、出流、壁面条件
- **求解器设置**: 时间步长、迭代次数、收敛标准

### 3. 可视化功能
- **3D流场显示**: 流线、压力场、速度矢量
- **河床变化动画**: 时间演化过程
- **浅蚀深度等值线**: 空间分布图
- **监测点曲线**: 时间历程数据

## 数据结构设计

### 1. 项目数据模型
```python
class ScourProject:
    def __init__(self):
        self.pier_geometry = PierGeometry()
        self.flow_conditions = FlowConditions()
        self.sediment_properties = SedimentProperties()
        self.mesh_settings = MeshSettings()
        self.solver_parameters = SolverParameters()
        self.results = SimulationResults()
```

### 2. 几何数据结构
```python
class PierGeometry:
    def __init__(self):
        self.shape = "circular"  # circular, rectangular, complex
        self.diameter = 1.0      # 直径/特征尺寸(m)
        self.height = 10.0       # 高度(m)
        self.position = [0, 0, 0] # 位置坐标
        self.angle = 0.0         # 倾斜角度
```

### 3. 流体参数
```python
class FlowConditions:
    def __init__(self):
        self.velocity = 2.0      # 流速(m/s)
        self.depth = 5.0         # 水深(m)
        self.temperature = 20.0   # 水温(°C)
        self.turbulence_intensity = 0.05
        self.approach_angle = 0.0 # 来流角度
```

## 计算流程设计

### 1. 预处理阶段
1. 几何建模和网格生成
2. 边界条件设置
3. 初始条件定义
4. 材料参数配置

### 2. 求解阶段
1. 流场初始化
2. 时间步进循环：
   - 流体力学求解
   - 泥沙输运计算
   - 河床更新
   - 收敛性检查
3. 后处理和结果输出

### 3. 后处理阶段
1. 结果数据提取
2. 可视化渲染
3. 统计分析
4. 报告生成

## 验证和测试策略

### 1. 算法验证
- 与经典实验数据对比（Melville实验）
- 标准算例测试（ASCE案例）
- 网格无关性验证

### 2. 界面测试
- 功能模块单元测试
- 用户交互测试
- 跨平台兼容性测试

### 3. 性能优化
- 算法并行化
- 内存使用优化
- 大规模案例测试

## 部署和分发

### 1. 环境要求
- Python 3.9+
- 64位操作系统
- 最小4GB RAM（推荐8GB+）
- 支持OpenGL 3.3+的显卡

### 2. 安装方式
```bash
# 克隆项目
git clone <repository_url>
cd example6

# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# 安装依赖
pip install -r requirements.txt

# 运行程序
python main.py
```

### 3. 打包分发
- 使用PyInstaller创建可执行文件
- 提供Docker容器版本
- 制作安装包

## 扩展功能规划

### 1. 高级功能
- 多桥墩相互影响分析
- 三维复杂地形处理
- 实时监测数据接入
- 机器学习预测模型

### 2. 集成功能
- 与DeepCAD主系统集成
- CAD文件导入支持
- 数据库连接功能
- 云计算支持

## 开发进度计划

### 阶段1: 核心算法实现 (1-2周)
- 浅蚀计算引擎
- 基础流体力学模型
- 数据结构设计

### 阶段2: GUI界面开发 (1-2周)  
- PyQt6主界面
- 参数设置面板
- 基础可视化功能

### 阶段3: 集成和优化 (1周)
- 模块集成测试
- 性能优化
- 用户体验改进

### 阶段4: 验证和文档 (1周)
- 算法验证
- 用户手册编写
- 案例库建设

## 总结

本技术文档提供了桥墩浅蚀模拟系统的完整设计方案，结合了现代GUI技术和成熟的计算流体力学算法。系统既能满足工程实用需求，又具有良好的可扩展性和用户体验。通过合理的模块化设计和丰富的可视化功能，将为桥梁工程师提供强大而易用的浅蚀分析工具。