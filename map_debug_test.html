<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°å›¾åŠ è½½è¯Šæ–­æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
        }
        .test-container {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #333;
            border-radius: 8px;
            background: #2a2a2a;
        }
        .map-container {
            width: 100%;
            height: 300px;
            border: 1px solid #555;
            margin-top: 10px;
            position: relative;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.loading { background: #2196F3; }
        .status.success { background: #4CAF50; }
        .status.error { background: #f44336; }
        .test-button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover { background: #1976D2; }
    </style>
</head>
<body>
    <h1>ğŸ—ºï¸ DeepCAD åœ°å›¾åŠ è½½è¯Šæ–­å·¥å…·</h1>
    
    <!-- æµ‹è¯•1: é«˜å¾·åœ°å›¾ -->
    <div class="test-container">
        <h2>æµ‹è¯•1: é«˜å¾·åœ°å›¾API</h2>
        <button class="test-button" onclick="testAMap()">ğŸ§ª æµ‹è¯•é«˜å¾·åœ°å›¾</button>
        <div id="amap-status" class="status">ç­‰å¾…æµ‹è¯•...</div>
        <div id="amap-container" class="map-container"></div>
    </div>
    
    <!-- æµ‹è¯•2: OpenStreetMap -->
    <div class="test-container">
        <h2>æµ‹è¯•2: OpenStreetMap (å¤‡ç”¨æ–¹æ¡ˆ)</h2>
        <button class="test-button" onclick="testOSM()">ğŸ§ª æµ‹è¯•OSMåœ°å›¾</button>
        <div id="osm-status" class="status">ç­‰å¾…æµ‹è¯•...</div>
        <div id="osm-container" class="map-container"></div>
    </div>
    
    <!-- æµ‹è¯•3: WebGLæ”¯æŒ -->
    <div class="test-container">
        <h2>æµ‹è¯•3: WebGLæ”¯æŒæ£€æµ‹</h2>
        <button class="test-button" onclick="testWebGL()">ğŸ§ª æ£€æµ‹WebGL</button>
        <div id="webgl-status" class="status">ç­‰å¾…æµ‹è¯•...</div>
        <div id="webgl-info"></div>
    </div>
    
    <!-- æµ‹è¯•4: ç½‘ç»œè¿æ¥ -->
    <div class="test-container">
        <h2>æµ‹è¯•4: ç½‘ç»œè¿æ¥æµ‹è¯•</h2>
        <button class="test-button" onclick="testNetwork()">ğŸ§ª æµ‹è¯•ç½‘ç»œ</button>
        <div id="network-status" class="status">ç­‰å¾…æµ‹è¯•...</div>
        <div id="network-info"></div>
    </div>

    <script src="https://webapi.amap.com/loader.js"></script>
    <script>
        // æµ‹è¯•é«˜å¾·åœ°å›¾
        async function testAMap() {
            const statusEl = document.getElementById('amap-status');
            const containerEl = document.getElementById('amap-container');
            
            statusEl.className = 'status loading';
            statusEl.textContent = 'ğŸ”„ æ­£åœ¨åŠ è½½é«˜å¾·åœ°å›¾...';
            
            try {
                const AMapLoader = window.AMapLoader;
                
                const AMap = await AMapLoader.load({
                    key: '4a7c8d1adf162d30d8a29941ee5de12f', // æµ‹è¯•å¯†é’¥
                    version: '2.0',
                    plugins: ['AMap.Scale', 'AMap.Marker']
                });
                
                const map = new AMap.Map(containerEl, {
                    center: [116.4074, 39.9042],
                    zoom: 10,
                    viewMode: '3D',
                    pitch: 45
                });
                
                statusEl.className = 'status success';
                statusEl.textContent = 'âœ… é«˜å¾·åœ°å›¾åŠ è½½æˆåŠŸï¼';
                
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = `âŒ é«˜å¾·åœ°å›¾åŠ è½½å¤±è´¥: ${error.message}`;
                console.error('é«˜å¾·åœ°å›¾é”™è¯¯:', error);
            }
        }
        
        // æµ‹è¯•OpenStreetMap
        function testOSM() {
            const statusEl = document.getElementById('osm-status');
            const containerEl = document.getElementById('osm-container');
            
            statusEl.className = 'status loading';
            statusEl.textContent = 'ğŸ”„ æ­£åœ¨åŠ è½½OSMåœ°å›¾...';
            
            // ç®€å•çš„OSMç“¦ç‰‡åœ°å›¾å®ç°
            containerEl.innerHTML = `
                <div style="
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(135deg, #4a90e2 0%, #7b68ee 100%);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 16px;
                ">
                    <div style="text-align: center;">
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ—ºï¸</div>
                        <div>OSMåœ°å›¾æ¨¡æ‹Ÿæ˜¾ç¤º</div>
                        <div style="font-size: 12px; opacity: 0.8; margin-top: 5px;">
                            (å®é™…é¡¹ç›®ä¸­ä¼šåŠ è½½çœŸå®ç“¦ç‰‡)
                        </div>
                    </div>
                </div>
            `;
            
            statusEl.className = 'status success';
            statusEl.textContent = 'âœ… OSMå¤‡ç”¨æ–¹æ¡ˆå¯ç”¨ï¼';
        }
        
        // æµ‹è¯•WebGLæ”¯æŒ
        function testWebGL() {
            const statusEl = document.getElementById('webgl-status');
            const infoEl = document.getElementById('webgl-info');
            
            statusEl.className = 'status loading';
            statusEl.textContent = 'ğŸ”„ æ£€æµ‹WebGLæ”¯æŒ...';
            
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                
                if (gl) {
                    const info = {
                        vendor: gl.getParameter(gl.VENDOR),
                        renderer: gl.getParameter(gl.RENDERER),
                        version: gl.getParameter(gl.VERSION),
                        maxTextureSize: gl.getParameter(gl.MAX_TEXTURE_SIZE)
                    };
                    
                    statusEl.className = 'status success';
                    statusEl.textContent = 'âœ… WebGLæ”¯æŒæ­£å¸¸ï¼';
                    
                    infoEl.innerHTML = `
                        <div style="margin-top: 10px; font-size: 12px;">
                            <div><strong>æ˜¾å¡å‚å•†:</strong> ${info.vendor}</div>
                            <div><strong>æ¸²æŸ“å™¨:</strong> ${info.renderer}</div>
                            <div><strong>WebGLç‰ˆæœ¬:</strong> ${info.version}</div>
                            <div><strong>æœ€å¤§çº¹ç†å°ºå¯¸:</strong> ${info.maxTextureSize}</div>
                        </div>
                    `;
                } else {
                    throw new Error('WebGLä¸æ”¯æŒ');
                }
                
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.textContent = `âŒ WebGLæ£€æµ‹å¤±è´¥: ${error.message}`;
                infoEl.innerHTML = '<div style="color: #f44336; margin-top: 10px;">æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒWebGLï¼Œæ— æ³•ä½¿ç”¨3Dåœ°å›¾åŠŸèƒ½</div>';
            }
        }
        
        // æµ‹è¯•ç½‘ç»œè¿æ¥
        async function testNetwork() {
            const statusEl = document.getElementById('network-status');
            const infoEl = document.getElementById('network-info');
            
            statusEl.className = 'status loading';
            statusEl.textContent = 'ğŸ”„ æµ‹è¯•ç½‘ç»œè¿æ¥...';
            
            const tests = [
                { name: 'é«˜å¾·åœ°å›¾API', url: 'https://webapi.amap.com/maps' },
                { name: 'OpenStreetMap', url: 'https://tile.openstreetmap.org/0/0/0.png' },
                { name: 'Cesium Ion', url: 'https://api.cesium.com/v1/' }
            ];
            
            const results = [];
            
            for (const test of tests) {
                try {
                    const startTime = Date.now();
                    const response = await fetch(test.url, { 
                        method: 'HEAD',
                        mode: 'no-cors',
                        cache: 'no-cache'
                    });
                    const endTime = Date.now();
                    
                    results.push({
                        name: test.name,
                        status: 'âœ… å¯è®¿é—®',
                        time: `${endTime - startTime}ms`
                    });
                } catch (error) {
                    results.push({
                        name: test.name,
                        status: 'âŒ æ— æ³•è®¿é—®',
                        error: error.message
                    });
                }
            }
            
            const allSuccess = results.every(r => r.status.includes('âœ…'));
            
            statusEl.className = allSuccess ? 'status success' : 'status error';
            statusEl.textContent = allSuccess ? 'âœ… ç½‘ç»œè¿æ¥æ­£å¸¸ï¼' : 'âš ï¸ éƒ¨åˆ†æœåŠ¡æ— æ³•è®¿é—®';
            
            infoEl.innerHTML = `
                <div style="margin-top: 10px; font-size: 12px;">
                    ${results.map(r => `
                        <div style="margin: 5px 0;">
                            <strong>${r.name}:</strong> ${r.status} 
                            ${r.time ? `(${r.time})` : ''}
                            ${r.error ? `- ${r.error}` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡ŒWebGLæ£€æµ‹
        window.onload = function() {
            testWebGL();
        };
    </script>
</body>
</html>
