# DeepCAD-SCOUR 桥墩浅蚀模拟系统

## 概述

DeepCAD-SCOUR是一个专业的桥墩浅蚀模拟系统，集成了经验公式和数值计算方法，为桥梁工程师提供全面的冲刷深度预测和分析工具。

## 系统特性

### 🔬 双重求解器架构
- **经验公式求解器**: 集成HEC-18、Melville-Coleman、CSU、Sheppard-Miller等经典公式
- **FEniCS数值求解器**: 基于有限元方法的精确数值计算
- **智能求解器管理**: 自动选择最适合的计算方法

### 🎯 核心功能
- **多方法对比**: 同时使用多种方法计算并对比结果
- **结果验证**: 自动评估结果可信度和一致性
- **参数敏感性分析**: 分析不同参数对冲刷深度的影响
- **3D可视化**: 支持流场和冲刷形态的三维显示

### 💻 现代化界面
- **PyQt6界面**: 专业级工程软件界面设计
- **实时参数调整**: 支持参数实时调整和结果更新
- **图表分析**: 内置matplotlib图表分析功能
- **报告导出**: 支持多种格式的计算报告导出

## 文件结构

```
example6/
├── main.py                    # 主程序入口
├── requirements.txt           # 依赖包列表
├── test_system.py            # 系统测试脚本
├── README.md                 # 本说明文件
├── core/                     # 核心计算模块
│   ├── __init__.py
│   ├── empirical_solver.py   # 经验公式求解器
│   ├── fenics_solver.py      # FEniCS数值求解器
│   └── solver_manager.py     # 求解器管理器
└── gui/                      # 图形界面模块
    ├── __init__.py
    └── main_window.py         # 主窗口界面
```

## 快速开始

### 1. 安装依赖

```bash
# 安装基础依赖
pip install -r requirements.txt

# 可选：安装FEniCS（用于数值计算）
# 注意：FEniCS安装较复杂，建议参考官方文档
conda install -c conda-forge fenics
```

### 2. 运行测试

```bash
# 运行系统测试，验证所有功能
python test_system.py
```

### 3. 启动GUI

```bash
# 启动图形界面
python main.py
```

## 使用指南

### 经验公式计算

系统集成了四种主要的经验公式：

1. **HEC-18公式** (美国联邦公路管理局)
   - 适用条件：弗劳德数 < 0.8，相对水深 > 2.0
   - 特点：应用最广泛，有详细的修正系数

2. **Melville-Coleman公式**
   - 适用条件：圆形桥墩，亚临界流
   - 特点：考虑时间演化，结果较保守

3. **CSU公式** (科罗拉多州立大学)
   - 适用条件：圆形桥墩，宽水道
   - 特点：基于大量实验数据，精度较高

4. **Sheppard-Miller公式**
   - 适用条件：复杂流场条件
   - 特点：考虑雷诺数影响，适用范围广

### 数值计算

当FEniCS可用时，系统提供：
- **Navier-Stokes方程求解**: 精确的流体力学计算
- **湍流模型**: 支持k-ε、k-ω SST等模型
- **网格自适应**: 桥墩周围自动网格加密
- **沉积物输运**: 考虑床面剪切应力和颗粒输运

### 参数设置

#### 桥墩几何参数
- 桥墩形状：圆形、矩形、椭圆形、复杂形状
- 特征直径：桥墩的特征尺寸（m）
- 倾斜角度：桥墩相对垂直方向的倾角（度）

#### 流体条件参数
- 来流速度：河道的平均流速（m/s）
- 水深：桥墩位置的水深（m）
- 来流角度：水流与桥墩轴线的夹角（度）

#### 沉积物参数
- 中值粒径（d50）：沉积物的中值粒径（mm）
- 沉积物密度：通常为2650 kg/m³
- 水密度：通常为1000 kg/m³

#### 环境参数
- 水温：影响水的粘度（°C）
- 重力加速度：通常为9.81 m/s²

## 计算结果

### 主要输出参数

- **冲刷深度**：桥墩周围的最大冲刷深度（m）
- **冲刷宽度**：冲刷坑的横向范围（m）
- **冲刷体积**：总冲刷体积（m³）
- **平衡时间**：达到稳定冲刷的时间（h）
- **临界流速**：开始冲刷的临界流速（m/s）

### 无量纲参数

- **雷诺数**：Re = VD/ν，表征流动的惯性力与粘性力之比
- **弗劳德数**：Fr = V/√(gh)，表征惯性力与重力之比
- **流速比**：V/Vc，实际流速与临界流速之比

### 结果验证

系统自动进行结果验证：
- **一致性评估**：对比不同方法的计算结果
- **可信度分析**：基于适用条件评估结果可信度
- **异常检测**：识别可能的异常结果
- **保守性检查**：确保工程安全的保守估计

## 高级功能

### 参数敏感性分析

系统支持自动进行参数敏感性分析：
- 分析各参数对冲刷深度的影响程度
- 识别关键控制参数
- 生成敏感性图表

### 批量计算

支持批量处理多组参数：
```python
# 示例：批量计算不同桥墩直径的冲刷深度
from core.solver_manager import create_default_manager
from core.empirical_solver import ScourParameters, PierShape

manager = create_default_manager()
diameters = [1.0, 1.5, 2.0, 2.5, 3.0]

results = []
for d in diameters:
    params = ScourParameters(
        pier_diameter=d,
        pier_shape=PierShape.CIRCULAR,
        flow_velocity=0.8,
        water_depth=3.0,
        d50=0.8
    )
    result = manager.solve(params)
    results.append((d, result.scour_depth))
```

### 结果导出

支持多种格式的结果导出：
- **Markdown报告**：包含详细计算过程和结果分析
- **JSON数据**：结构化数据便于后续处理
- **CSV表格**：适合Excel等软件处理
- **VTK格式**：用于ParaView等专业可视化软件

## 技术说明

### 经验公式实现

系统中的经验公式严格按照原文献实现，包括：
- 完整的修正系数计算
- 适用条件检查
- 结果可信度评估
- 警告信息提示

### 数值求解方法

当FEniCS可用时，数值求解包含：
- **几何建模**：使用mshr进行几何建模和网格生成
- **方程求解**：Taylor-Hood元素求解Navier-Stokes方程
- **湍流处理**：实现多种湍流模型
- **边界条件**：正确设置入口、出口、壁面边界条件

### 求解器选择逻辑

系统根据以下条件自动选择求解器：
- **流动复杂性**：高弗劳德数、大攻角倾向数值计算
- **计算精度需求**：研究级别使用数值计算
- **计算时间约束**：工程应用优先经验公式
- **结果验证需求**：重要项目使用混合模式

## 限制和注意事项

### 经验公式适用性
- 各公式都有特定的适用条件
- 超出适用范围时结果可信度下降
- 复杂几何和流场条件精度有限

### 数值计算限制
- 需要安装FEniCS（可选）
- 计算时间较长
- 需要合理的网格和时间参数

### 系统要求
- Python 3.7+
- PyQt6
- numpy, scipy, matplotlib
- 可选：FEniCS, PyVista

## 验证和校准

系统已通过以下验证：
- **标准算例对比**：与文献中的标准算例对比
- **实验数据验证**：与物理模型实验数据对比
- **软件交叉验证**：与其他专业软件结果对比

## 开发和扩展

### 添加新的经验公式

```python
# 在empirical_solver.py中添加新方法
def new_formula(self, params: ScourParameters) -> ScourResult:
    # 实现新的经验公式
    scour_depth = calculate_new_formula(params)
    return ScourResult(
        scour_depth=scour_depth,
        method="新方法名称",
        # ... 其他结果参数
    )

# 在solve方法中添加调用
if method == "all" or method == "新方法名称":
    results["新方法名称"] = self.new_formula(params)
```

### 自定义GUI组件

系统采用模块化设计，可以轻松添加新的GUI组件：
- 继承existing的Panel类
- 实现setup_ui()和setup_style()方法
- 在主窗口中集成新组件

## 支持和反馈

如有问题或建议，请通过以下方式联系：
- 技术支持：检查代码注释和文档字符串
- 功能请求：可在代码基础上扩展
- Bug报告：通过测试脚本验证问题

## 许可证

本软件仅供学术研究和工程参考使用。

---

**注意**：桥墩冲刷是一个复杂的工程问题，本软件的计算结果应结合工程经验和现场调研进行综合判断。对于重要工程项目，建议进行物理模型试验验证。