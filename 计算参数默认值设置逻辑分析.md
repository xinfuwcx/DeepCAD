# 🔧 计算参数默认值设置逻辑分析

**3号计算专家 - 专业参数 + 智能默认值策略**

## 🎯 设计理念：专业完整 + 智能默认

```
🎛️ 参数层次策略:
├── 🟢 基础参数 (显示，智能默认) - 80%用户只需这些
├── 🟡 高级参数 (折叠，专业默认) - 15%用户需要调整  
└── 🔴 专家参数 (隐藏，规范默认) - 5%专家深度定制
```

---

## 🌍 土体材料参数 - 最关键的参数组

### 📋 土层基础参数 (🟢 基础显示)

```typescript
interface SoilLayerBasicParams {
  // 🎯 用户必填参数 (无默认值)
  layer_name: string;                    // "杂填土" - 用户必须明确
  top_elevation: number;                 // 顶面标高 - 来自钻孔数据
  bottom_elevation: number;              // 底面标高 - 来自钻孔数据
  
  // 🎯 核心力学参数 (智能默认值)
  unit_weight: number;                   // 重度 kN/m³
  cohesion: number;                      // 粘聚力 kPa  
  friction_angle: number;                // 内摩擦角 °
  elastic_modulus: number;               // 变形模量 MPa
  poisson_ratio: number;                 // 泊松比
}

// 🤖 智能默认值策略 (基于土层类型)
const SOIL_DEFAULTS = {
  '杂填土': {
    unit_weight: 18.0,      // 经验值：松散填土
    cohesion: 15.0,         // 经验值：有一定粘聚力
    friction_angle: 12.0,   // 经验值：较低摩擦角
    elastic_modulus: 5.0,   // 经验值：变形模量较小
    poisson_ratio: 0.35,    // 经验值：接近饱和土
    confidence: 0.7         // 默认值可信度70%
  },
  
  '粉质粘土': {
    unit_weight: 19.5,      // 经验值：典型粘性土
    cohesion: 25.0,         // 经验值：中等粘聚力
    friction_angle: 18.0,   // 经验值：粘性土摩擦角
    elastic_modulus: 12.0,  // 经验值：中等变形模量  
    poisson_ratio: 0.32,    // 经验值：典型粘土
    confidence: 0.85        // 默认值可信度85%
  },
  
  '中砂': {
    unit_weight: 20.0,      // 经验值：密实砂土
    cohesion: 0.0,          // 理论值：纯砂土无粘聚力
    friction_angle: 30.0,   // 经验值：中密砂土
    elastic_modulus: 25.0,  // 经验值：砂土模量较高
    poisson_ratio: 0.28,    // 经验值：砂土典型值
    confidence: 0.9         // 默认值可信度90%
  }
};
```

**📊 参数逻辑分析：**

1. **重度 (unit_weight)**
   - **物理意义**：土体单位体积重量，影响自重应力
   - **默认值逻辑**：填土<粘土<砂土，基于土粒密度和孔隙比
   - **敏感性**：中等，影响初始应力场

2. **粘聚力 (cohesion)**  
   - **物理意义**：土体抗剪强度的粘聚分量
   - **默认值逻辑**：砂土=0，粘土>填土，基于土粒粘结
   - **敏感性**：高，直接影响稳定性计算

3. **内摩擦角 (friction_angle)**
   - **物理意义**：土体抗剪强度的摩擦分量  
   - **默认值逻辑**：砂土>粘土>填土，基于颗粒接触
   - **敏感性**：高，关键安全参数

---

### 🔧 土层高级参数 (🟡 折叠显示)

```typescript
interface SoilLayerAdvancedParams {
  // 🎯 渗透特性
  permeability_horizontal: number;       // 水平渗透系数 m/s
  permeability_vertical: number;         // 垂直渗透系数 m/s  
  
  // 🎯 本构模型参数
  constitutive_model: 'linear_elastic' | 'mohr_coulomb' | 'drucker_prager';
  dilatancy_angle: number;              // 剪胀角 °
  
  // 🎯 动力特性 (地震分析用)
  shear_modulus: number;                // 剪切模量 MPa
  damping_ratio: number;                // 阻尼比
}

// 🤖 高级参数默认值
const ADVANCED_DEFAULTS = {
  '粉质粘土': {
    permeability_horizontal: 1e-8,      // 典型粘土渗透系数
    permeability_vertical: 5e-9,        // 垂直渗透系数更小
    constitutive_model: 'mohr_coulomb', // 经典土力学模型
    dilatancy_angle: 0.0,               // 粘土一般不剪胀
    shear_modulus: 4.8,                 // G = E/2(1+ν)
    damping_ratio: 0.05                 // 典型土体阻尼
  }
};
```

**📊 高级参数逻辑：**

4. **渗透系数 (permeability)**
   - **工程意义**：控制渗流分析精度
   - **默认值逻辑**：粘土<砂土，各向异性考虑
   - **使用场景**：降水、渗流稳定分析

5. **本构模型 (constitutive_model)**
   - **计算意义**：决定应力-应变关系
   - **默认值逻辑**：Mohr-Coulomb最通用
   - **专业程度**：高级用户才需要调整

---

## 🏗️ 结构材料参数

### 📋 混凝土参数 (🟢 基础显示)

```typescript
interface ConcreteParams {
  // 🎯 基础强度参数
  concrete_grade: 'C25' | 'C30' | 'C35' | 'C40';  // 混凝土等级
  elastic_modulus: number;               // 弹性模量 GPa
  poisson_ratio: number;                 // 泊松比
  density: number;                       // 密度 kg/m³
  
  // 🎯 强度参数  
  compressive_strength: number;          // 抗压强度 MPa
  tensile_strength: number;              // 抗拉强度 MPa
}

// 🤖 混凝土等级默认值 (基于规范GB50010)
const CONCRETE_DEFAULTS = {
  'C30': {
    elastic_modulus: 30.0,              // 规范值：3.0×10⁴ MPa
    poisson_ratio: 0.2,                 // 规范值：混凝土典型值
    density: 2500,                      // 规范值：钢筋混凝土
    compressive_strength: 30.0,         // 等级定义值
    tensile_strength: 2.5,              // 规范值：fc/12
    confidence: 0.95                    // 规范值可信度95%
  }
};
```

**📊 混凝土参数逻辑：**

6. **混凝土等级**
   - **工程意义**：直接关联所有力学参数
   - **默认值策略**：C30最常用，一键设置所有参数
   - **用户友好**：选等级比填数字更直观

---

## ⚙️ 求解器参数

### 📋 收敛控制参数 (🟡 高级参数)

```typescript
interface SolverParams {
  // 🎯 基础求解参数
  analysis_type: 'static' | 'dynamic' | 'eigenvalue';
  solver_type: 'direct' | 'iterative';
  
  // 🎯 收敛控制
  residual_tolerance: number;           // 残差容差
  displacement_tolerance: number;       // 位移容差  
  max_iterations: number;               // 最大迭代次数
  
  // 🎯 非线性控制
  enable_geometric_nonlinearity: boolean;
  enable_material_nonlinearity: boolean;
}

// 🤖 求解器默认值 (基于数值计算经验)
const SOLVER_DEFAULTS = {
  analysis_type: 'static',              // 90%分析是静态
  solver_type: 'direct',                // 直接法更稳定
  residual_tolerance: 1e-6,             // 工程精度要求
  displacement_tolerance: 1e-6,         // 位移收敛标准
  max_iterations: 30,                   // 经验值：平衡精度和效率
  enable_geometric_nonlinearity: true,  // 深基坑大变形
  enable_material_nonlinearity: false   // 一般分析线性够用
};
```

**📊 求解器参数逻辑：**

7. **收敛容差**
   - **数值意义**：平衡计算精度和速度
   - **默认值策略**：1e-6工程够用，1e-8科研用
   - **专业程度**：普通用户不需要修改

---

## 🎯 参数分层显示策略

### 🟢 **基础参数面板** (默认显示)
```
📋 土层参数设置
├── 土层名称: [杂填土        ▼] (下拉选择，触发默认值)
├── 重度:     [18.0     ] kN/m³  💡 基于土层类型自动填充
├── 粘聚力:   [15.0     ] kPa    💡 可调整，默认值来自经验
├── 摩擦角:   [12.0     ] °     💡 关键参数，建议实测
└── 变形模量: [5.0      ] MPa   💡 影响变形计算
```

### 🟡 **高级参数面板** (点击展开)
```
🔧 高级参数 [展开 ▼]
├── 渗透系数: [1e-8     ] m/s   💡 影响渗流分析
├── 本构模型: [Mohr-Coulomb ▼] 💡 一般不需要改
├── 剪胀角:   [0.0      ] °     💡 粘土通常为0
└── 阻尼比:   [0.05     ]       💡 动力分析用
```

### 🔴 **专家参数面板** (专家模式)
```
⚙️ 专家参数 [专家模式 ▼]  
├── 硬化参数: [详细设置...]    💡 需要试验确定
├── 状态参数: [详细设置...]    💡 高级本构用
└── 数值参数: [详细设置...]    💡 求解器优化
```

## 💡 **智能默认值的价值**

### 🎯 **用户体验**
- **新手友好**：选择土层类型，自动填充所有参数
- **专家高效**：默认值作为起点，微调关键参数
- **结果可靠**：基于工程经验和规范的默认值

### 🤖 **智能化特点**
- **参数关联**：选择C30混凝土，自动设置弹模、强度等
- **合理性检查**：参数超出合理范围时自动警告
- **经验提示**：每个参数都有工程意义说明

这样既保持了专业完整性，又大大降低了使用门槛！你觉得这个参数分层和默认值策略怎么样？