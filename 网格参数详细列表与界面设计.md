# 📐 网格参数详细列表与界面设计

**DeepCAD网格生成模块 - 完整参数体系与界面示意图**

## 📋 网格参数完整清单

### 🟢 **基础网格参数** (用户必看)

```typescript
interface BasicMeshParams {
  // 1. 全局尺寸控制
  globalElementSize: number;            // 全局单元尺寸 (m) - 默认: 2.0
  minElementSize: number;               // 最小单元尺寸 (m) - 默认: 0.5
  maxElementSize: number;               // 最大单元尺寸 (m) - 默认: 5.0
  
  // 2. 网格算法选择
  meshAlgorithm: 'Delaunay' | 'Frontal' | 'BAMG' | 'MeshAdapt';  // 默认: Delaunay
  
  // 3. 网格类型
  elementType: 'tetrahedron' | 'hexahedron' | 'mixed';          // 默认: tetrahedron
  surfaceMeshing: boolean;              // 表面网格 - 默认: true
  volumeMeshing: boolean;               // 体积网格 - 默认: true
  
  // 4. 质量控制
  qualityThreshold: number;             // 质量阈值 0-1 - 默认: 0.3
  adaptiveMeshing: boolean;             // 自适应网格 - 默认: true
}
```

### 🟡 **高级网格参数** (折叠显示)

```typescript
interface AdvancedMeshParams {
  // 5. 尺寸梯度控制
  sizeGradationFactor: number;          // 尺寸梯度因子 - 默认: 1.3
  maximumGradation: number;             // 最大梯度 - 默认: 2.0
  
  // 6. 边界层网格
  boundaryLayerEnabled: boolean;        // 启用边界层 - 默认: false
  boundaryLayerThickness: number;       // 边界层厚度 - 默认: 0.1
  boundaryLayerLayers: number;          // 边界层层数 - 默认: 3
  boundaryLayerGrowthRate: number;      // 增长率 - 默认: 1.2
  
  // 7. 网格优化
  meshSmoothing: boolean;               // 网格平滑 - 默认: true
  smoothingIterations: number;          // 平滑迭代次数 - 默认: 3
  nodeOptimization: boolean;            // 节点优化 - 默认: true
  
  // 8. 几何容差
  geometryTolerance: number;            // 几何容差 - 默认: 1e-6
  angleTolerance: number;               // 角度容差 (度) - 默认: 1.0
}
```

### 🔴 **专家网格参数** (专家模式)

```typescript
interface ExpertMeshParams {
  // 9. 高级算法控制
  meshingStrategy: 'aggressive' | 'conservative' | 'balanced';  // 默认: balanced
  parallelMeshing: boolean;             // 并行网格生成 - 默认: true
  threadCount: number;                  // 线程数 - 默认: 4
  
  // 10. 内存管理
  memoryLimit: number;                  // 内存限制 (GB) - 默认: 8
  tempFileCleanup: boolean;             // 清理临时文件 - 默认: true
  
  // 11. 调试选项
  verboseOutput: boolean;               // 详细输出 - 默认: false
  meshingDiagnostics: boolean;          // 网格诊断 - 默认: false
  saveIntermediateFiles: boolean;       // 保存中间文件 - 默认: false
}
```

### 🎯 **区域细化参数** (Fragment相关)

```typescript
interface RefinementZoneParams {
  // 12. 细化区域定义
  refinementZones: Array<{
    id: string;                         // 区域ID
    name: string;                       // 区域名称
    type: 'box' | 'sphere' | 'cylinder' | 'surface' | 'geometry';
    
    // 几何定义
    geometry: {
      center?: [number, number, number];
      size?: [number, number, number];
      radius?: number;
      height?: number;
    };
    
    // 细化参数
    targetElementSize: number;          // 目标单元尺寸
    transitionDistance: number;         // 过渡距离
    refinementReason: string;           // 细化原因
    priority: number;                   // 优先级 1-10
    enabled: boolean;                   // 是否启用
  }>;
  
  // 13. 自动细化规则
  autoRefinementRules: {
    excavationBoundary: {
      enabled: boolean;                 // 开挖边界细化 - 默认: true
      refinementFactor: number;         // 细化因子 - 默认: 0.5
      influenceRadius: number;          // 影响半径 - 默认: 5.0
    };
    
    structureInterface: {
      enabled: boolean;                 // 结构接触面细化 - 默认: true  
      refinementFactor: number;         // 细化因子 - 默认: 0.4
      influenceRadius: number;          // 影响半径 - 默认: 3.0
    };
    
    materialInterface: {
      enabled: boolean;                 // 材料界面细化 - 默认: true
      refinementFactor: number;         // 细化因子 - 默认: 0.6
      influenceRadius: number;          // 影响半径 - 默认: 2.0
    };
  };
}
```

---

## 🎨 网格参数设置界面示意图

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          📐 DeepCAD网格生成参数设置                                      │
│                             3D场景预览 + 参数控制面板                                    │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────┐  ┌─────────────────────────────────────────────────────────┐
│    🎛️ 网格参数控制面板      │  │                  📊 3D网格预览场景                      │
│                            │  │  ┌───────────────────────────────────────────────────┐ │
│ 🟢 基础参数 [已展开 ▼]      │  │  │           🌍 实时网格预览                          │ │
│                            │  │  │                                                  │ │
│ 全局单元尺寸:               │  │  │    🏗️ 基坑模型    📐 网格线框                    │ │
│ [━━━━●━━━━━] 2.0m           │  │  │                                                  │ │
│                            │  │  │    🌱 土体域      🔧 细化区域                    │ │
│ 最小单元尺寸:               │  │  │                                                  │ │
│ [━●━━━━━━━━] 0.5m           │  │  │    📊 网格统计:                                  │ │
│                            │  │  │    节点: 45,680  单元: 38,520                    │ │
│ 最大单元尺寸:               │  │  │    质量: 87%     内存: 156MB                     │ │
│ [━━━━━━━━━●] 5.0m           │  │  │                                                  │ │
│                            │  │  └───────────────────────────────────────────────────┘ │
│ 网格算法:                   │  │                                                        │
│ [Delaunay      ▼]          │  │  🎯 操作按钮:                                           │
│                            │  │  [🚀 生成网格] [🔄 重新生成] [👁️ 显示/隐藏]             │
│ 单元类型:                   │  │  [📊 质量报告] [💾 导出网格] [⚙️ 高级设置]             │
│ [四面体        ▼]          │  └─────────────────────────────────────────────────────────┘
│                            │
│ ☑️ 表面网格  ☑️ 体积网格     │
│ ☑️ 自适应    ☑️ 质量优化     │
│                            │
│ 质量阈值:                   │
│ [━━━●━━━━━━] 0.3            │
│                            │
│ 🟡 高级参数 [点击展开 ▶]     │
│                            │
│ 🎯 区域细化 [已展开 ▼]       │
│                            │
│ ┌────────────────────────┐ │
│ │ 📍 支护结构界面区域     │ │
│ │ 单元尺寸: 0.8m         │ │
│ │ 理由: 应力集中         │ │
│ │ [✅启用] [⚙️编辑] [🗑️删除] │ │
│ └────────────────────────┘ │
│                            │
│ ┌────────────────────────┐ │
│ │ 📍 开挖边界区域         │ │
│ │ 单元尺寸: 1.0m         │ │  
│ │ 理由: 变形梯度大       │ │
│ │ [✅启用] [⚙️编辑] [🗑️删除] │ │
│ └────────────────────────┘ │
│                            │
│ ┌────────────────────────┐ │
│ │ 📍 桩土接触面区域       │ │
│ │ 单元尺寸: 0.6m         │ │
│ │ 理由: 相互作用重要     │ │
│ │ [✅启用] [⚙️编辑] [🗑️删除] │ │
│ └────────────────────────┘ │
│                            │
│ [➕ 添加细化区域]            │
│ [📋 区域模板]               │
│                            │
│ 🔴 专家参数 [专家模式 ▶]     │
│                            │
└─────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          📊 网格生成进度与质量监控                                        │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        🔄 生成进度监控               │ │            📈 质量指标实时监控               │ │
│ │                                    │ │                                            │ │
│ │ 当前阶段: 体积网格生成              │ │ 网格质量分布:                               │ │
│ │ ████████████░░░░ 78%               │ │ 🟢 优秀: 65%  🔵 良好: 25%                 │ │
│ │                                    │ │ 🟡 可接受: 8%  🔴 差: 2%                   │ │
│ │ 已处理: 28,450 / 36,500 单元        │ │                                            │ │
│ │ 预计剩余: 45秒                      │ │ 长宽比: 平均 2.8 (良好)                     │ │
│ │                                    │ │ 偏斜度: 平均 0.15 (优秀)                    │ │
│ │ [⏸️ 暂停] [⏹️ 停止] [📊 详细日志]    │ │ 雅可比: 最小 0.08 (警告)                    │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          🟡 高级参数面板 (点击展开后显示)                                  │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        🔧 尺寸与梯度控制             │ │            🎯 边界层网格设置                 │ │
│ │                                    │ │                                            │ │
│ │ 尺寸梯度因子:                       │ │ ☐ 启用边界层网格                            │ │
│ │ [━━━●━━━━━━] 1.3                    │ │                                            │ │
│ │                                    │ │ 边界层厚度: [0.1     ] m                   │ │
│ │ 最大梯度:                           │ │ 边界层层数: [3       ] 层                  │ │
│ │ [━━━━●━━━━━] 2.0                    │ │ 增长率:     [1.2     ]                     │ │
│ │                                    │ │                                            │ │
│ │ 几何容差:                           │ │ 应用对象:                                   │ │
│ │ [1e-6      ]                       │ │ ☑️ 地连墙表面  ☑️ 开挖面                    │ │
│ │                                    │ │ ☐ 桩基表面    ☐ 所有边界                   │ │
│ │ 角度容差:                           │ │                                            │ │
│ │ [1.0       ] 度                    │ │                                            │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
│                                                                                         │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        ⚙️ 网格优化设置               │ │            🖥️ 性能与内存设置                │ │
│ │                                    │ │                                            │ │
│ │ ☑️ 网格平滑                         │ │ ☑️ 并行网格生成                             │ │
│ │ 平滑迭代: [3     ] 次               │ │ 线程数: [4       ] 个                      │ │
│ │                                    │ │                                            │ │
│ │ ☑️ 节点位置优化                     │ │ 内存限制: [8.0    ] GB                     │ │
│ │ 优化策略: [拉普拉斯 ▼]              │ │                                            │ │
│ │                                    │ │ ☑️ 自动清理临时文件                         │ │
│ │ ☑️ 单元质量改善                     │ │ ☐ 详细日志输出                             │ │
│ │ 改善阈值: [0.2   ]                 │ │ ☐ 保存中间结果                             │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          🔴 专家参数面板 (专家模式才显示)                                  │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        🧠 算法策略控制               │ │            🔬 调试与诊断工具                 │ │
│ │                                    │ │                                            │ │
│ │ 网格策略:                           │ │ ☐ 详细输出模式                             │ │
│ │ [平衡模式      ▼]                   │ │ ☐ 网格诊断报告                             │ │
│ │                                    │ │ ☐ 算法性能分析                             │ │
│ │ 收敛准则:                           │ │ ☐ 内存使用追踪                             │ │
│ │ [残差+能量     ▼]                   │ │                                            │ │
│ │                                    │ │ 诊断输出目录:                               │ │
│ │ 最大重试次数: [3     ]              │ │ [选择目录...]                              │ │
│ │                                    │ │                                            │ │
│ │ 失败处理:                           │ │ 日志级别:                                   │ │
│ │ [自动降级      ▼]                   │ │ [详细        ▼]                           │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

## 🎯 **关键网格参数默认值逻辑**

### 📐 **全局尺寸参数**
- **globalElementSize: 2.0m** - 基于80m基坑的1/40，平衡精度和效率
- **minElementSize: 0.5m** - 全局尺寸的1/4，避免过度细化
- **maxElementSize: 5.0m** - 全局尺寸的2.5倍，远场粗化

### 🔧 **算法选择**
- **meshAlgorithm: 'Delaunay'** - 最稳定通用的算法
- **elementType: 'tetrahedron'** - 复杂几何适应性最好
- **qualityThreshold: 0.3** - 保证数值稳定的最低要求

### 🎯 **细化策略**
- **支护结构界面: 0.8m** - 应力集中区域需要细化
- **开挖边界: 1.0m** - 变形梯度大的区域
- **桩土接触面: 0.6m** - 相互作用最重要的区域

这个界面设计既保持了专业完整性，又通过分层展示降低了复杂度！你觉得这些参数的默认值合理吗？