# 🔧 网格设置和计算设置界面详细设计

**DeepCAD深基坑CAE系统 - 网格生成与计算分析设置界面分工**

## 📐 网格生成界面 (MeshGenerationModule)
**负责人：2号几何专家协助，0号架构师整合**

### 🎯 主要职责
- **网格参数设置**：单元尺寸、算法选择、质量控制
- **Fragment域定义**：几何域划分、网格密度分区
- **网格质量评估**：Kratos格式转换、质量指标计算
- **与2号几何专家协作**：接收优化几何、应用网格参数

---

## 🔧 网格设置界面详细功能

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          📐 网格生成参数控制面板                                          │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        🎛️ 基础网格参数              │ │            🎯 网格算法设置                   │ │
│ │                                    │ │                                            │ │
│ │ 全局单元尺寸: [━━━━━━━●━━] 2.0m      │ │ 网格算法: [Delaunay    ▼]                   │ │
│ │ 最小单元尺寸: [━━●━━━━━━━] 0.5m      │ │ 单元类型: [四面体      ▼]                   │ │
│ │ 最大单元尺寸: [━━━━━━━━━━●] 5.0m      │ │ 质量阈值: [━━━━━●━━━━━] 0.7                  │ │
│ │                                    │ │                                            │ │
│ │ ☑️ 表面网格  ☑️ 体积网格            │ │ ☑️ 自适应网格  ☑️ 网格平滑                   │ │
│ │ ☑️ 质量优化  ☑️ 边界层网格          │ │ ☑️ Fragment模式 ☑️ 并行生成                 │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          🎯 Fragment域定义与网格细化                                      │
│                                                                                         │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │     🏗️ 支护结构界面域                │ │           🌍 土体分层域                      │ │
│ │                                    │ │                                            │ │
│ │ 域类型: structure                  │ │ 域类型: soil_domain                        │ │
│ │ 单元尺寸: 0.8m                     │ │ 单元尺寸: 2.0m                             │ │
│ │ 优先级: 高                         │ │ 优先级: 中                                 │ │
│ │ 理由: 应力集中区域                  │ │ 理由: 标准土体网格                          │ │
│ │ [✅ 启用] [⚙️ 编辑] [🗑️ 删除]      │ │ [✅ 启用] [⚙️ 编辑] [🗑️ 删除]             │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
│                                                                                         │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │      ⛏️ 开挖边界域                  │ │          🔧 桩土接触面域                     │ │
│ │                                    │ │                                            │ │
│ │ 域类型: excavation                 │ │ 域类型: interface                          │ │
│ │ 单元尺寸: 1.0m                     │ │ 单元尺寸: 0.6m                             │ │
│ │ 优先级: 高                         │ │ 优先级: 高                                 │ │
│ │ 理由: 变形梯度大                    │ │ 理由: 相互作用重要                          │ │
│ │ [✅ 启用] [⚙️ 编辑] [🗑️ 删除]      │ │ [✅ 启用] [⚙️ 编辑] [🗑️ 删除]             │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
│                                                                                         │
│                          [➕ 添加新域] [📋 域模板] [🔄 批量设置]                        │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          📊 网格质量实时监控                                              │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        📈 质量指标统计               │ │            🎯 Kratos兼容性检查               │ │
│ │                                    │ │                                            │ │
│ │ 总单元数: 45,680                   │ │ ✅ Kratos格式: 已转换                       │ │
│ │ 总节点数: 52,340                   │ │ ✅ 单元类型: 兼容                          │ │
│ │ 长宽比: 2.8 (良好)                 │ │ ✅ 材料属性: 已映射                        │ │
│ │ 偏斜度: 0.15 (优秀)                │ │ ✅ 边界条件: 就绪                          │ │
│ │ 雅可比: 0.92 (优秀)                │ │                                            │ │
│ │ 正交性: 0.92 (优秀)                │ │ 质量评分: 92/100 🟢                        │ │
│ │ 内存占用: 89MB                     │ │ 计算就绪度: 98% 🟢                         │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## ⚡ 计算设置界面 (ComputationControlPanel)
**负责人：3号计算专家**

### 🎯 主要职责
- **荷载定义**：表面荷载、施工荷载、邻近建筑荷载
- **边界条件设置**：位移约束、压力边界、接触条件
- **材料属性配置**：土体参数、结构材料、接触面参数
- **分析步骤控制**：施工阶段、时间步长、求解控制

---

## 🔧 计算设置界面详细功能

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          🏗️ 荷载定义与边界条件设置                                        │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        📊 荷载系统配置               │ │            🔒 边界约束条件                   │ │
│ │                                    │ │                                            │ │
│ │ 地面超载: [━━━━●━━━━━] 20 kPa        │ │ 底部边界: [固定约束    ▼]                   │ │
│ │ 施工荷载: [━━●━━━━━━━] 10 kPa        │ │ X方向: ☑️固定  Y方向: ☑️固定  Z方向: ☑️固定   │ │
│ │ 车辆荷载: [━━━━━●━━━━] 15 kPa        │ │                                            │ │
│ │                                    │ │ 侧边界: [法向约束      ▼]                   │ │
│ │ 邻近建筑:                          │ │ 距离边界: [━━━━━●━━━━] 50m                   │ │
│ │ 距离: 25m  荷载: 150kPa  深度: 3m   │ │ 约束类型: ☑️法向固定 ☐切向自由               │ │
│ │                                    │ │                                            │ │
│ │ [➕ 添加荷载] [📋 荷载组合] [🎯 定位] │ │ [➕ 添加约束] [🔧 高级设置] [📐 可视化]       │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          🧱 材料属性与本构关系设置                                        │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │      🌍 土体材料属性                │ │           🏗️ 结构材料属性                    │ │
│ │                                    │ │                                            │ │
│ │ 📋 土层1: 杂填土                   │ │ 📋 混凝土: C30                             │ │
│ │ 重度: 18.0 kN/m³                  │ │ 弹性模量: 30 GPa                           │ │
│ │ 粘聚力: 15 kPa                     │ │ 泊松比: 0.2                               │ │
│ │ 摩擦角: 12°                       │ │ 抗压强度: 30 MPa                           │ │
│ │ 弹性模量: 5 MPa                    │ │ 抗拉强度: 2.5 MPa                          │ │
│ │ 泊松比: 0.35                      │ │                                            │ │
│ │ 渗透系数: 1e-6 m/s                 │ │ 📋 钢材: Q355B                             │ │
│ │ 本构模型: [Mohr-Coulomb ▼]         │ │ 弹性模量: 200 GPa                          │ │
│ │                                    │ │ 泊松比: 0.3                               │ │
│ │ 📋 土层2: 粉质粘土 [🔧编辑]         │ │ 屈服强度: 355 MPa                          │ │
│ │ 📋 土层3: 中砂 [🔧编辑]             │ │                                            │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          🏗️ 施工阶段与分析步骤设置                                        │
│                                                                                         │
│ 📋 第1阶段: 地连墙施工              ⏱️  时长: 7天     状态: [✅ 激活]                    │
│ ├─ 激活元素: 地连墙单元             📊 荷载系数: 1.0   🔧 材料: 混凝土C30                │
│ ├─ 边界条件: 底部固定               🌊 地下水: 初始水位 ⚡ 特殊效应: 混凝土养护            │
│ └─ 监测点: 墙体应力、土体位移        [⚙️ 详细设置] [📊 预览] [🔄 复制]                   │
│                                                                                         │
│ 📋 第2阶段: 第一层开挖              ⏱️  时长: 3天     状态: [⏸️ 等待]                    │
│ ├─ 移除元素: 0~-3m土体单元          📊 荷载系数: 1.0   🔧 开挖深度: 3m                  │
│ ├─ 新增荷载: 开挖面卸荷             🌊 地下水: 降水-1m  ⚡ 特殊效应: 应力释放            │
│ └─ 监测点: 墙体变形、周边沉降        [⚙️ 详细设置] [📊 预览] [🔄 复制]                   │
│                                                                                         │
│ 📋 第3阶段: 第一道支撑安装          ⏱️  时长: 2天     状态: [⏸️ 等待]                    │ 
│ ├─ 激活元素: 钢支撑单元             📊 预应力: 800kN   🔧 材料: Q355B钢材               │
│ ├─ 接触定义: 支撑-墙体接触          🌊 地下水: 持续降水 ⚡ 特殊效应: 预应力施加            │
│ └─ 监测点: 支撑轴力、接触压力        [⚙️ 详细设置] [📊 预览] [🔄 复制]                   │
│                                                                                         │
│                        [➕ 添加阶段] [📋 模板] [🔄 批量编辑] [📊 甘特图]                  │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          ⚙️ 求解器参数与收敛控制                                          │
│ ┌─────────────────────────────────────┐ ┌─────────────────────────────────────────────┐ │
│ │        🔧 求解器设置                │ │            📈 收敛控制参数                   │ │
│ │                                    │ │                                            │ │
│ │ 求解器类型: [Newton-Raphson ▼]     │ │ 残差容差: [━━●━━━━━━━] 1e-6                  │ │
│ │ 分析类型: [静态分析      ▼]        │ │ 位移容差: [━━●━━━━━━━] 1e-6                  │ │
│ │ 时间步长: [━━━━●━━━━━] 0.1         │ │ 最大迭代: [━━━━━━━●━━] 30次                  │ │
│ │ 总时间: [━━━━━━━━━●] 10.0          │ │ 能量容差: [━━●━━━━━━━] 1e-8                  │ │
│ │                                    │ │                                            │ │
│ │ ☑️ 几何非线性  ☑️ 材料非线性        │ │ ☑️ 自适应步长 ☑️ 线搜索                     │ │
│ │ ☑️ 接触非线性  ☑️ 大变形           │ │ ☑️ 残差监控   ☑️ 发散检测                   │ │
│ │                                    │ │                                            │ │
│ │ 并行线程: [━━━━━━━●━━] 8线程        │ │ 求解器预处理: [ILU    ▼]                   │ │
│ │ 内存限制: [━━━━━━━━●━] 16GB         │ │ 预条件器: [GMRES      ▼]                   │ │
│ └─────────────────────────────────────┘ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                          🎯 专业设置快捷面板                                              │
│ ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐      │
│ │  🏗️ 深基坑预设   │ │  🌉 桥梁基础    │ │  🏢 地下空间    │ │  🚇 隧道工程    │      │
│ │                │ │                │ │                │ │                │      │
│ │ 📋 荷载组合1     │ │ 📋 荷载组合2    │ │ 📋 荷载组合3    │ │ 📋 荷载组合4    │      │
│ │ 🔒 约束模式A     │ │ 🔒 约束模式B    │ │ 🔒 约束模式C    │ │ 🔒 约束模式D    │      │
│ │ 🧱 材料库α      │ │ 🧱 材料库β     │ │ 🧱 材料库γ     │ │ 🧱 材料库δ     │      │
│ │ ⚙️ 求解器配置X   │ │ ⚙️ 求解器配置Y  │ │ ⚙️ 求解器配置Z  │ │ ⚙️ 求解器配置W  │      │
│ │                │ │                │ │                │ │                │      │
│ │ [📋 应用模板]   │ │ [📋 应用模板]   │ │ [📋 应用模板]   │ │ [📋 应用模板]   │      │
│ └─────────────────┘ └─────────────────┘ └─────────────────┘ └─────────────────┘      │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🔄 界面协作流程

### 📐 网格生成 → ⚡ 计算设置
1. **网格质量检查**：网格界面生成高质量网格，传递Kratos格式数据
2. **单元信息传递**：单元类型、节点坐标、连接关系自动导入计算设置
3. **域信息映射**：Fragment域自动映射为材料分区和边界条件

### ⚡ 计算设置 → 📐 网格优化
1. **网格反馈**：计算发现网格质量问题，反馈给网格生成
2. **细化建议**：高应力梯度区域建议网格细化
3. **迭代优化**：网格-计算-反馈-优化的闭环循环

---

## 📊 关键设计特点

### 🎯 网格界面特点
- **Fragment导向**：支持复杂几何域的独立网格控制
- **质量实时监控**：Kratos兼容性检查和质量指标实时显示
- **2号专家协作**：接收几何优化参数，应用智能网格建议

### ⚡ 计算界面特点
- **施工阶段导向**：基于实际施工过程的分析步骤设置
- **专业模板系统**：深基坑、桥梁、隧道等工程模板快速应用
- **AI智能建议**：基于工程经验的参数推荐和优化建议

### 🤝 协作集成特点
- **数据无缝传递**：网格数据自动导入计算设置，避免重复配置
- **质量闭环控制**：计算质量问题自动反馈网格优化
- **实时状态同步**：两个界面状态实时同步，保证数据一致性

这个设计充分体现了专业CAE软件的工作流程，网格生成专注于几何离散化质量，计算设置专注于物理问题定义，两者协作形成完整的CAE前处理系统！